# ××¢×¨×›×ª ×¢×‘×•×“×” ××•×¤×œ×™×™×Ÿ - ×ª×™×¢×•×“ ××œ×

## ×¡×§×™×¨×” ×›×œ×œ×™×ª

××¢×¨×›×ª ××œ××” ×œ×¢×‘×•×“×” ××•×¤×œ×™×™×Ÿ ×¢× ×¡× ×›×¨×•×Ÿ ××•×˜×•××˜×™ ×‘×™×Ÿ:
- **IndexedDB** (××§×•××™ - ××•×¤×œ×™×™×Ÿ)
- **Supabase** (×©×¨×ª ××¨×›×–×™)
- **iCount** (××¢×¨×›×ª ×—×™×¦×•× ×™×ª)

×”××¢×¨×›×ª ××‘×˜×™×—×”:
âœ… ×¢×‘×•×“×” ××œ××” ×’× ×œ×œ× ××™× ×˜×¨× ×˜
âœ… ××™×Ÿ ×›×¤×™×œ×•×™×•×ª ×©×œ ××¡×¤×¨×™ ×”×–×× ×•×ª (Sequences)
âœ… ×¡× ×›×¨×•×Ÿ ××•×˜×•××˜×™ ×›×©×—×•×–×¨×™× ××•× ×œ×™×™×Ÿ
âœ… ×ª××™×›×” ×‘-10+ ××—×©×‘×™× ×‘××§×‘×™×œ

---

## ××¨×›×™×˜×§×˜×•×¨×”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ××—×©×‘ 1                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  Frontend    â”‚â†â”€â”€â†’â”‚  IndexedDB   â”‚                  â”‚
â”‚  â”‚   (React)    â”‚    â”‚  (××•×¤×œ×™×™×Ÿ)   â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚         â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ Online
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Supabase (×©×¨×ª ××¨×›×–×™)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ PostgreSQL â”‚  â”‚  Sequences   â”‚  â”‚   RPC Funcs  â”‚   â”‚
â”‚  â”‚    DB      â”‚  â”‚  (Counters)  â”‚  â”‚  (Triggers)  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    iCount API                           â”‚
â”‚            (×—×©×‘×•× ×™×•×ª ×•××¡××›×™×)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ×§×‘×¦×™× ×©× ×•×¦×¨×•

### 1. Database Migration
**ğŸ“„ `migrations/007_sequences_for_numbers.sql`**

×™×•×¦×¨:
- Sequences ×œ××¡×¤×¨×™ ×”×–×× ×•×ª/×—×©×‘×•× ×™×•×ª/×œ×§×•×—×•×ª
- Functions: `get_next_order_number()`, `get_next_invoice_number()`, `get_next_customer_number()`
- Columns ×—×“×©×™×: `is_offline`, `sync_status`, `synced_at`, `last_modified_at`
- Indexes ×œ×‘×™×¦×•×¢×™×
- Triggers ×œ×¢×“×›×•×Ÿ ××•×˜×•××˜×™ ×©×œ `last_modified_at`

**×”×¨×¦×”:**
```sql
-- ×‘×¡×•×¤×‘×™×™×¡ SQL Editor:
-- ×”×¢×ª×§ ×•×”×“×‘×§ ××ª ×›×œ ×”×ª×•×›×Ÿ ××”×§×•×‘×¥ ×•×”×¨×¥
```

### 2. Offline Storage Layer
**ğŸ“„ `src/lib/offline/offlineDB.js`**

××™××•×© IndexedDB ×¢×:
- 4 Stores: orders, customers, invoices, sync_queue
- Methods: `put()`, `get()`, `getAll()`, `delete()`, `clear()`
- Query by index: `getByIndex()`
- Pending sync tracking: `getPendingSync()`, `getAllPendingSync()`
- Stats: `getStats()`

**×©×™××•×©:**
```javascript
import { offlineDB, STORES } from '@/lib/offline/offlineDB'

// ×©××™×¨×ª ×”×–×× ×”
await offlineDB.put(STORES.ORDERS, order)

// ×§×‘×œ×ª ×›×œ ×”×”×–×× ×•×ª
const orders = await offlineDB.getAll(STORES.ORDERS)

// ×§×‘×œ×ª ×”×–×× ×•×ª ×××ª×™× ×•×ª ×œ×¡× ×›×¨×•×Ÿ
const pending = await offlineDB.getPendingSync(STORES.ORDERS)
```

### 3. Sync Service
**ğŸ“„ `src/lib/offline/syncService.js`**

×©×™×¨×•×ª ×¡× ×›×¨×•×Ÿ ×“×•-×›×™×•×•× ×™:

**Methods:**
- `syncToSupabase()` - ×”×¢×œ××ª ×©×™× ×•×™×™× ××§×•××™×™× ×œ×©×¨×ª
- `syncFromSupabase()` - ×”×•×¨×“×ª ×©×™× ×•×™×™× ××”×©×¨×ª
- `fullSync()` - ×¡× ×›×¨×•×Ÿ ××œ× (×©× ×™ ×”×›×™×•×•× ×™×)
- `syncOrder()` - ×¡× ×›×¨×•×Ÿ ×”×–×× ×” ×‘×•×“×“×ª
- `getSyncStatus()` - ××¦×‘ ×”×¡× ×›×¨×•×Ÿ

**×©×™××•×©:**
```javascript
import { syncService } from '@/lib/offline/syncService'

// ×¡× ×›×¨×•×Ÿ ××œ×
const result = await syncService.fullSync()

// ×”××–× ×” ×œ×©×™× ×•×™×™ ×¡×˜×˜×•×¡
syncService.onSyncStatusChange((status) => {
  console.log('Sync status:', status)
})
```

### 4. React Hook for Offline
**ğŸ“„ `src/lib/offline/useOffline.js`**

Hook ×œ× ×™×”×•×œ ××¦×‘ ××•×¤×œ×™×™×Ÿ/××•× ×œ×™×™×Ÿ:

```javascript
import { useOffline } from '@/lib/offline/useOffline'

function MyComponent() {
  const {
    isOnline,      // ×”×× ××—×•×‘×¨ ×œ××™× ×˜×¨× ×˜
    syncStatus,    // ×¡×˜×˜×•×¡ ×”×¡× ×›×¨×•×Ÿ
    pendingCount,  // ×›××” ×¤×¨×™×˜×™× ×××ª×™× ×™×
    sync,          // ×¤×•× ×§×¦×™×™×ª ×¡× ×›×¨×•×Ÿ ×™×“× ×™×ª
    isSyncing      // ×”×× ×‘×ª×”×œ×™×š ×¡× ×›×¨×•×Ÿ
  } = useOffline()

  return (
    <div>
      {isOnline ? 'âœ… ××•× ×œ×™×™×Ÿ' : 'ğŸ“´ ××•×¤×œ×™×™×Ÿ'}
      {pendingCount > 0 && `${pendingCount} ×××ª×™× ×™× ×œ×¡× ×›×¨×•×Ÿ`}
    </div>
  )
}
```

### 5. Offline Orders API
**ğŸ“„ `src/lib/offline/offlineOrders.js`**

API ×œ× ×™×”×•×œ ×”×–×× ×•×ª ×¢× ×ª××™×›×” ××•×¤×œ×™×™×Ÿ:

```javascript
import {
  createOrder,
  updateOrder,
  getOrders,
  getOrder,
  deleteOrder
} from '@/lib/offline/offlineOrders'

// ×™×¦×™×¨×ª ×”×–×× ×” (×¢×•×‘×“ ×’× ××•×¤×œ×™×™×Ÿ!)
const result = await createOrder({
  customer_name: '××©×” ×›×”×Ÿ',
  total_with_vat: 1500,
  status: 'new'
})

// ×× ××•×¤×œ×™×™×Ÿ:
// result = { success: true, id: 'uuid-xxx', offline: true, pending: true }

// ×× ××•× ×œ×™×™×Ÿ:
// result = { success: true, id: 'uuid-xxx', order_number: 1001, offline: false }

// ×§×‘×œ×ª ×”×–×× ×•×ª (×ª××™×“ ××”×™×¨×” - ××§×•××™×ª)
const { orders, offline } = await getOrders()
```

### 6. Sync Indicator Component
**ğŸ“„ `src/components/SyncIndicator.jsx`**

××™× ×“×™×§×˜×•×¨ ×•×™×–×•××œ×™ ×œ××¦×‘ ×”×¡× ×›×¨×•×Ÿ:

××¦×™×’:
- âœ… ××¡×•× ×›×¨×Ÿ - ×™×¨×•×§
- ğŸ“´ ××•×¤×œ×™×™×Ÿ - ××“×•×
- ğŸ”„ ××¡× ×›×¨×Ÿ - ×›×—×•×œ (××¡×ª×•×‘×‘)
- âš ï¸ X ×××ª×™× ×™× - ×¦×”×•×‘

×›×•×œ×œ ×›×¤×ª×•×¨ "×¡× ×›×¨×Ÿ ×¢×›×©×™×•" ×›×©×™×© ×¤×¨×™×˜×™× ×××ª×™× ×™×.

### 7. API Endpoint
**ğŸ“„ `src/app/api/orders/sync/route.js`**

- **POST** - ×¡× ×›×¨×•×Ÿ ×”×–×× ×” ××—×ª
- **GET** - ×§×‘×œ×ª ×”×–×× ×•×ª ×©×”×©×ª× ×• ×××– ×ª××¨×™×š X

---

## ×ª×¨×—×™×©×™ ×©×™××•×©

### ×ª×¨×—×™×© 1: ×™×¦×™×¨×ª ×”×–×× ×” ××•× ×œ×™×™×Ÿ

```javascript
// 1. ××©×ª××© ×™×•×¦×¨ ×”×–×× ×”
const result = await createOrder({
  customer_name: '×“×•×“ ×œ×•×™',
  total_with_vat: 2500,
  status: 'new'
})

// 2. ×”××¢×¨×›×ª:
// âœ… ×©×•××¨×ª ×‘-IndexedDB ××§×•××™
// âœ… ××¡× ×›×¨× ×ª ××™×“ ×œ-Supabase
// âœ… ××§×‘×œ×ª ××¡×¤×¨ ×”×–×× ×” ×-Sequence: 1001
// âœ… ××¢×“×›× ×ª ××ª ×”×”×–×× ×” ×”××§×•××™×ª ×¢× ×”××¡×¤×¨

// 3. ×”×ª×•×¦××”:
// result = { success: true, order_number: 1001, offline: false }
```

### ×ª×¨×—×™×© 2: ×™×¦×™×¨×ª ×”×–×× ×” ××•×¤×œ×™×™×Ÿ

```javascript
// 1. ××©×ª××© ×™×•×¦×¨ ×”×–×× ×” (××™×Ÿ ××™× ×˜×¨× ×˜)
const result = await createOrder({
  customer_name: '×“×•×“ ×œ×•×™',
  total_with_vat: 2500,
  status: 'new'
})

// 2. ×”××¢×¨×›×ª:
// âœ… ×©×•××¨×ª ×‘-IndexedDB ××§×•××™
// âœ… ××¡×× ×ª: sync_status = 'pending', is_offline = true
// â³ order_number = null (×™×§×‘×œ ×›×©×™×¡×ª× ×›×¨×Ÿ)

// 3. ×”×ª×•×¦××”:
// result = { success: true, id: 'uuid-123', offline: true, pending: true }

// 4. ×›×©×—×•×–×¨×™× ××•× ×œ×™×™×Ÿ (××•×˜×•××˜×™!):
// ğŸ”„ ×”××¢×¨×›×ª ××–×”×” ×—×™×‘×•×¨
// ğŸ”„ ××¡× ×›×¨× ×ª ××ª ×”×”×–×× ×”
// ğŸ”„ ××§×‘×œ×ª ××¡×¤×¨ ×”×–×× ×”: 1001
// âœ… ××¢×“×›× ×ª ××ª ×”×”×–×× ×” ×”××§×•××™×ª
```

### ×ª×¨×—×™×© 3: ×©× ×™ ××—×©×‘×™× ×™×•×¦×¨×™× ×”×–×× ×” ×‘×• ×–×× ×™×ª

```javascript
// ××—×©×‘ 1 (××•× ×œ×™×™×Ÿ):
const result1 = await createOrder({ customer_name: '×œ×§×•×— 1' })
// ×§×•×¨× ×œ-Sequence: nextval('order_number_seq') â†’ 1001

// ××—×©×‘ 2 (××•× ×œ×™×™×Ÿ - ×‘×“×™×•×§ ×‘××•×ª×• ×–××Ÿ!):
const result2 = await createOrder({ customer_name: '×œ×§×•×— 2' })
// ×§×•×¨× ×œ-Sequence: nextval('order_number_seq') â†’ 1002

// PostgreSQL ××‘×˜×™×—:
// âœ… ××—×©×‘ 1 ××§×‘×œ 1001
// âœ… ××—×©×‘ 2 ××§×‘×œ 1002
// âœ… ××™×Ÿ ×›×¤×™×œ×•×ª!
```

### ×ª×¨×—×™×© 4: ××—×©×‘ ××•×¤×œ×™×™×Ÿ + ××—×©×‘ ××•× ×œ×™×™×Ÿ

```javascript
// ××—×©×‘ 1 (××•×¤×œ×™×™×Ÿ):
const result1 = await createOrder({ customer_name: '×œ×§×•×— 1' })
// ×©×•××¨ ××§×•××™×ª, order_number = null

// ××—×©×‘ 2 (××•× ×œ×™×™×Ÿ):
const result2 = await createOrder({ customer_name: '×œ×§×•×— 2' })
// ××§×‘×œ order_number = 1001 ××™×“

// ××—×©×‘ 1 ×—×•×–×¨ ××•× ×œ×™×™×Ÿ:
// ğŸ”„ ×¡× ×›×¨×•×Ÿ ××•×˜×•××˜×™
// âœ… ××§×‘×œ order_number = 1002
// âœ… ××™×Ÿ ×”×ª× ×’×©×•×ª!
```

---

## ×××©×§ API

### createOrder(orderData)
```javascript
const result = await createOrder({
  customer_name: '×©× ×œ×§×•×—',
  customer_phone: '050-1234567',
  total_with_vat: 1500,
  status: 'new',
  notes: '×”×¢×¨×•×ª'
})

// Returns:
// {
//   success: true,
//   id: 'uuid',
//   order_number: 1001 | null,
//   offline: false | true,
//   pending: false | true
// }
```

### updateOrder(orderId, updates)
```javascript
const result = await updateOrder('uuid-123', {
  status: 'in_progress',
  notes: '×”×¢×¨×” ×—×“×©×”'
})

// Returns: { success: true, offline: false | true }
```

### getOrders()
```javascript
const { orders, offline } = await getOrders()

// orders = [
//   {
//     id: 'uuid-123',
//     order_number: 1001 | null,
//     customer_name: '××©×” ×›×”×Ÿ',
//     sync_status: 'synced' | 'pending',
//     is_offline: false,
//     ...
//   }
// ]
```

### getOrder(orderId)
```javascript
const order = await getOrder('uuid-123')
```

### deleteOrder(orderId)
```javascript
const result = await deleteOrder('uuid-123')
```

### syncService.fullSync()
```javascript
const result = await syncService.fullSync()

// Returns:
// {
//   success: true,
//   upload: { synced: 5, total: 5 },
//   download: { orders: 3, customers: 2 }
// }
```

---

## ××™× ×“×™×§×˜×•×¨×™× ×‘×××©×§

### SyncIndicator
××•×¦×’ ×‘×¤×™× ×” ×”×©×××œ×™×ª ×”×¢×œ×™×•× ×”:

**××¦×‘×™×:**
1. **âœ… ××¡×•× ×›×¨×Ÿ** (×™×¨×•×§) - ×”×›×œ ×ª×§×™×Ÿ
2. **ğŸ“´ ××•×¤×œ×™×™×Ÿ** (××“×•×) - ××™×Ÿ ×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜
3. **ğŸ”„ ××¡× ×›×¨×Ÿ... X%** (×›×—×•×œ, ××¡×ª×•×‘×‘) - ×‘×ª×”×œ×™×š ×¡× ×›×¨×•×Ÿ
4. **âš ï¸ X ×××ª×™× ×™×** (×¦×”×•×‘) - ×™×© ×¤×¨×™×˜×™× ×œ×¡× ×›×¨×•×Ÿ
5. **âŒ ×©×’×™××ª ×¡× ×›×¨×•×Ÿ** (××“×•×) - × ×›×©×œ

### ×‘×”×–×× ×•×ª
```javascript
// ××™× ×“×™×§×˜×•×¨ ×‘×›×œ ×”×–×× ×”:
{order.order_number
  ? `×”×–×× ×” #${order.order_number}`   // ××¡×¤×¨ ×¨×’×™×œ
  : 'â³ ×××ª×™×Ÿ ×œ×¡× ×›×¨×•×Ÿ'                 // ××•×¤×œ×™×™×Ÿ
}

// Badge ×¡×˜×˜×•×¡:
{order.sync_status === 'pending' && (
  <span className="bg-yellow-100 text-yellow-800">×××ª×™×Ÿ ×œ×¡× ×›×¨×•×Ÿ</span>
)}
```

---

## ×”×ª×§× ×” ×•×”×¨×¦×”

### ×©×œ×‘ 1: ×”×¨×¥ Migration
```sql
-- ×‘-Supabase SQL Editor:
-- ×”×¢×ª×§ ××ª migrations/007_sequences_for_numbers.sql ×•×”×¨×¥
```

### ×©×œ×‘ 2: ××™××•×ª
```sql
-- ×‘×“×•×§ ×©-Sequences × ×•×¦×¨×•:
SELECT * FROM sequence_status;

-- ×‘×“×•×§ ×©×”×¤×•× ×§×¦×™×•×ª ×¢×•×‘×“×•×ª:
SELECT get_next_order_number();  -- ×××•×¨ ×œ×”×—×–×™×¨ ××¡×¤×¨
```

### ×©×œ×‘ 3: ×”×©×ª××© ×‘-Offline API
```javascript
// ×‘×›×œ ×“×£/×§×•××¤×•× × ×˜×”:
import { createOrder, getOrders } from '@/lib/offline/offlineOrders'
import { useOffline } from '@/lib/offline/useOffline'

function OrdersPage() {
  const { isOnline, pendingCount } = useOffline()

  // ... use createOrder, getOrders
}
```

---

## ×©××œ×•×ª × ×¤×•×¦×•×ª

### ×©: ××” ×§×•×¨×” ×× ×©× ×™ ××—×©×‘×™× ×™×•×¦×¨×™× ×”×–×× ×” ×‘×“×™×•×§ ×‘××•×ª×• ×–××Ÿ?
**×ª:** PostgreSQL Sequence ××‘×˜×™×— ×©×›×œ ××—×©×‘ ×™×§×‘×œ ××¡×¤×¨ ×©×•× ×”. ×–×” thread-safe ×œ×—×œ×•×˜×™×Ÿ.

### ×©: ××” ×§×•×¨×” ×× ×”××—×©×‘ × ×›×‘×” ×œ×¤× ×™ ×”×¡× ×›×¨×•×Ÿ?
**×ª:** ×”×”×–×× ×” ×©××•×¨×” ×‘-IndexedDB (persistent storage). ×›×©×”××—×©×‘ ×™×™×“×œ×§ ×•×™×”×™×” ××•× ×œ×™×™×Ÿ, ×”×¡× ×›×¨×•×Ÿ ×™×ª×‘×¦×¢ ××•×˜×•××˜×™×ª.

### ×©: ××™×š ××•×—×§×™× ××ª ×›×œ ×”× ×ª×•× ×™× ×”××§×•××™×™×?
**×ª:**
```javascript
await offlineDB.clear(STORES.ORDERS)
await offlineDB.clear(STORES.CUSTOMERS)
await offlineDB.clear(STORES.INVOICES)
```

### ×©: ××” ×”×”×‘×“×œ ×‘×™×Ÿ sync_status ×œ×‘×™×Ÿ is_offline?
**×ª:**
- `is_offline`: ×”×× × ×•×¦×¨ ×‘××¦×‘ ××•×¤×œ×™×™×Ÿ (×”×™×¡×˜×•×¨×™)
- `sync_status`: ××¦×‘ × ×•×›×—×™ - 'pending', 'syncing', 'synced', 'conflict'

### ×©: ××™×š ×œ×‘×“×•×§ ×›××” ×¤×¨×™×˜×™× ×××ª×™× ×™× ×œ×¡× ×›×¨×•×Ÿ?
**×ª:**
```javascript
const stats = await offlineDB.getStats()
console.log(`Pending: ${stats.pendingSync}`)
```

---

## ×‘×™×¦×•×¢×™×

### ××”×™×¨×•×ª
- **×™×¦×™×¨×ª ×”×–×× ×” ××•×¤×œ×™×™×Ÿ**: ~5-10ms (IndexedDB)
- **×™×¦×™×¨×ª ×”×–×× ×” ××•× ×œ×™×™×Ÿ**: ~100-200ms (Supabase + Sequence)
- **×¡× ×›×¨×•×Ÿ 100 ×”×–×× ×•×ª**: ~5-10 ×©× ×™×•×ª

### ××—×¡×•×Ÿ
- IndexedDB: ×¢×“ 50% ×× ×¤×— ×”×“×™×¡×§ ×”×¤× ×•×™ (Chrome)
- ×‘×¤×•×¢×œ: ××œ×¤×™ ×”×–×× ×•×ª = ×›××” MB

---

## ×ª×—×–×•×§×”

### × ×™×§×•×™ × ×ª×•× ×™× ×™×©× ×™×
```javascript
// ××—×§ ×”×–×× ×•×ª ×™×©× ×•×ª ××¢×œ 3 ×—×•×“×©×™×
const threeMonthsAgo = new Date()
threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3)

const orders = await offlineDB.getAll(STORES.ORDERS)
for (const order of orders) {
  if (new Date(order.created_at) < threeMonthsAgo && order.sync_status === 'synced') {
    await offlineDB.delete(STORES.ORDERS, order.id)
  }
}
```

### Reset Sequence
```sql
-- ×× ×¦×¨×™×š ×œ××¤×¡ ××ª ×”××¡×¤×¨×™× (×–×”×™×¨×•×ª!):
SELECT setval('order_number_seq', 1000, false);
```

---

## ××¡×§× ×”

×”××¢×¨×›×ª ××‘×˜×™×—×”:
âœ… **××™×Ÿ ×›×¤×™×œ×•×ª** - Sequences ××‘×˜×™×—×•×ª ×™×™×—×•×“×™×•×ª
âœ… **×¢×•×‘×“ ××•×¤×œ×™×™×Ÿ** - IndexedDB ×©×•××¨ ×”×›×œ ××§×•××™×ª
âœ… **×¡× ×›×¨×•×Ÿ ××•×˜×•××˜×™** - ×›×©×—×•×–×¨×™× ××•× ×œ×™×™×Ÿ
âœ… **××”×™×¨** - Local-first architecture
âœ… **×¡×§×œ×‘×™×œ×™×•×ª** - ×ª×•××š ×‘××™× ×¡×•×£ ××—×©×‘×™×

**×”××¢×¨×›×ª ××•×›× ×” ×œ×©×™××•×© ×‘×™×™×¦×•×¨!** ğŸš€

---
× ×•×¦×¨: 2026-01-14
